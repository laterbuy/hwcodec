// 这是一个示例补丁文件，展示如何将 nv_decode.cpp 修改为使用 Rust 实现
// 实际修改时，请直接编辑源文件

// ============================================================================
// 修改 1: 添加头文件（在文件开头，其他 include 之后）
// ============================================================================
#include "platform/win/win_rust_wrapper.h"

// ============================================================================
// 修改 2: 替换类名（行 109）
// ============================================================================
// 修改前:
//   std::unique_ptr<NativeDevice> native_ = nullptr;
// 修改后:
std::unique_ptr<NativeDeviceRust> native_ = nullptr;

// ============================================================================
// 修改 3: 替换构造函数调用（行 139）
// ============================================================================
// 修改前:
//   native_ = std::make_unique<NativeDevice>();
// 修改后:
native_ = std::make_unique<NativeDeviceRust>();

// ============================================================================
// 修改 4: 替换 Adapters 使用（行 657-661）
// ============================================================================
// 修改前:
//   Adapters adapters;
//   if (!adapters.Init(ADAPTER_VENDOR_NVIDIA))
//     return -1;
//   int count = 0;
//   for (auto &adapter : adapters.adapters_) {
//     int64_t currentLuid = LUID(adapter.get()->desc1_);
//
// 修改后:
AdaptersRust adapters;
if (!adapters.Init(ADAPTER_VENDOR_NVIDIA))
  return -1;
int count = 0;
for (int i = 0; i < adapters.GetCount(); i++) {
  int64_t currentLuid = adapters.GetAdapterLuid(i);
